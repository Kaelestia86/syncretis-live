<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Realms of Syncretis ‚Äì Live Session</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="app">
    <header>
      <h1>Realms of Syncretis ‚Äì Live Session</h1>
    </header>

    <!-- ================= CONNECT ================= -->
    <section id="connectSection">
      <h2>Connect</h2>

      <div class="row">
        <label>Session ID:
          <input type="text" id="sessionIdInput" placeholder="e.g. ECHO-1" />
        </label>
      </div>

      <div class="row">
        <label>Name:
          <input type="text" id="playerNameInput" placeholder="Your Warden name" />
        </label>
      </div>

      <div class="row">
        <label>Race:
          <select id="raceSelect">
            <option value="">-- Select Race --</option>
            <option value="Aethrial">Aethrial</option>
            <option value="Vey'ruun">Vey'ruun</option>
            <option value="Lumirite">Lumirite</option>
            <option value="Dralith">Dralith</option>
          </select>
        </label>
      </div>

      <div class="row">
        <label>Class:
          <select id="classSelect">
            <option value="">-- Select Class --</option>

            <optgroup label="Claws of Dragoon">
              <option value="Talons of Dragoon">Talons of Dragoon</option>
              <option value="Scales of Dragoon">Scales of Dragoon</option>
              <option value="Eyes of Dragoon">Eyes of Dragoon</option>
            </optgroup>

            <optgroup label="Heart of Dragoon">
              <option value="Tempest Weaver">Tempest Weaver</option>
              <option value="Ember Sage">Ember Sage</option>
              <option value="Heart-Stone">Heart-Stone</option>
              <option value="Tears">Tears</option>
            </optgroup>

            <optgroup label="Shades of Dragoon">
              <option value="Eclipsar">Eclipsar</option>
              <option value="Rhythm of Dragoon">Rhythm of Dragoon</option>
              <option value="Shadow Weaver">Shadow Weaver</option>
            </optgroup>

            <optgroup label="Other / Custom">
              <option value="Custom Warden">Custom Warden</option>
            </optgroup>
          </select>
        </label>
      </div>

      <div class="row">
        <label>
          <input type="checkbox" id="isSwCheckbox" />
          I am the Story Weaver
        </label>
      </div>

      <button id="joinBtn">Join Session</button>
      <button id="rejoinBtn">Rejoin Saved Session</button>
      <div id="connectStatus"></div>
    </section>

    <!-- ================= NAV ================= -->
    <nav id="mainNav" class="hidden">
      <button data-tab="playerTab">Player</button>
      <button data-tab="storyWeaverTab" id="swTabButton">Story Weaver</button>
    </nav>

    <main>
      <!-- ================= PLAYER TAB ================= -->
      <section id="playerTab" class="tab hidden">
        <h2>Player Panel</h2>

        <!-- ===== PLAYER INFO ===== -->
        <div id="playerInfo">
          <p><strong>Name:</strong> <span id="playerNameDisplay">-</span></p>
          <p><strong>Race:</strong> <span id="playerRaceDisplay">-</span></p>
          <p><strong>Class:</strong> <span id="playerClassDisplay">-</span></p>

          <!-- HP -->
          <div class="stat-row">
            <p><strong>HP:</strong> <span id="hpDisplay">0 / 0</span></p>
            <div class="meter" aria-label="HP bar">
              <div id="hpFill" class="meter-fill hp"></div>
            </div>
          </div>

          <div class="hp-buttons">
            <button data-hp-delta="-1">-1</button>
            <button data-hp-delta="1">+1</button>
            <button data-hp-delta="-5">-5</button>
            <button data-hp-delta="5">+5</button>
            <button onclick="healToFull()">Full</button>
          </div>

          <!-- LEVEL -->
          <p><strong>Level:</strong> <span id="levelDisplay">1</span></p>

          <!-- LEVEL CONTROLS (‚úî CORRECT LOCATION) -->
          <section id="levelControls" class="stat-block">
            <h3>‚¨ÜÔ∏è Level Controls</h3>
            <div class="level-buttons">
              <button id="levelUpBtn">Level Up (3d6 HP)</button>
              <button id="levelDownBtn">Level Down (undo last)</button>
            </div>
          </section>
        </div>

        <!-- ===== NEXUS ===== -->
        <section id="nexusSection" class="stat-block">
          <h3>Nexus</h3>

          <div class="nexus-buttons">
            <button data-nexus-delta="-1">-1</button>
            <button data-nexus-delta="1">+1</button>
            <button data-nexus-delta="-5">-5</button>
            <button data-nexus-delta="5">+5</button>
            <button onclick="resetNexus()">Reset</button>
          </div>

          <div class="stat-row">
            <div class="nexus-display">
              <strong>Nexus:</strong>
              <span id="nexusValue">0</span> / <span id="maxNexusValue">0</span>
            </div>

            <div class="meter" aria-label="Nexus bar">
              <div id="nexusFill" class="meter-fill nexus"></div>
            </div>
          </div>
        </section>

        <!-- ===== STRESS ===== -->
        <section id="stressSection" class="stat-block">
          <h3>Stress</h3>
          <div id="stressBar" class="stress-bar" aria-label="Stress bar"></div>
          <div class="stress-buttons">
            <button data-stress-delta="-1">-1</button>
            <button data-stress-delta="1">+1</button>
            <button onclick="resetStress()">Reset</button>
          </div>
        </section>

        <!-- ===== DICE ===== -->
        <section id="diceRoller">
          <h3>üé≤ Dice Roller</h3>

          <label>
            # Dice:
            <input id="diceCountInput" type="number" min="1" max="20" value="1">
          </label>

          <button class="die-btn" data-die="6">Roll D6</button>
          <button class="die-btn" data-die="10">Roll D10</button>
          <button class="die-btn" data-die="20">Roll D20</button>

          <div id="diceResults"></div>
        </section>

        <!-- ===== SKILLS ===== -->
        <section id="classSkills" class="stat-block">
          <h3>Class Skills</h3>
          <p id="classSkillsHint" class="skills-hint">
            Select a class above, then click a skill to roll, spend Nexus, and deal damage.
          </p>
          <div id="skillsContainer"></div>
          <div id="skillResult" class="skill-result"></div>
        </section>

        <!-- ===== PARTY ===== -->
        <section id="playersListSection">
          <h3>Party</h3>
          <ul id="playersList" class="player-list"></ul>
        </section>
      </section>

      <!-- ================= STORY WEAVER TAB ================= -->
      <section id="storyWeaverTab" class="tab hidden">
        <h2>üìú Story Weaver</h2>

        <section>
          <h3>Map</h3>
          <div id="mapDisplay">
            <canvas id="mapCanvas" width="1100" height="650"></canvas>
          </div>

          <div id="swMapControls">
            <input type="file" id="mapUpload" accept=".jpg,.jpeg,image/jpeg" />
            <input type="text" id="mapUrlInput" placeholder="Paste map image URL..." />
            <button id="setMapBtn">Set Map (URL)</button>
            <button id="addEnemyTokenBtn">‚ûï Add Enemy Pip</button>
            <button id="deleteSelectedTokenBtn">üóëÔ∏è Delete Selected</button>
          </div>
        </section>

        <section>
          <h3>Conflict Management</h3>
          <div id="conflictInfo">No active conflict.</div>

          <h4>Add Enemy</h4>
<div class="row">
  <label>Enemy:
    <select id="enemySelect"></select>
  </label>
  <button id="addEnemyBtn">Add Enemy</button>
</div>

<h4>Monster Index</h4>
<div id="monsterIndex" class="monster-index"></div>

<h4>Enemies</h4>
<div id="enemyPanel"></div>

          <h4>Combat Log</h4>
          <div id="combatLog"></div>

          <input type="text" id="conflictNameInput" placeholder="Conflict name..." />
          <button id="startConflictBtn">Start Conflict</button>
          <button id="endConflictBtn">End Conflict</button>
        </section>
      </section>
    </main>
  </div>

  <script src="enemy_defs.js"></script>
  <script src="client.js"></script>
</body>
</html>
